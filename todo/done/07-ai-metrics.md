# Phase 7: AI Work Metrics Dashboard

## Overview
Add a dedicated dashboard page to track and evaluate AI-assisted development work, including co-authored commits, AI adoption rates, and productivity impact analysis.

## Prerequisites
- Phase 3 (Dashboard MVP) completed
- Phase 2 (Data Schema) updated with AI fields

## Background
Modern development increasingly involves AI assistants like GitHub Copilot, Claude Code, Cursor, and others. These tools typically add co-author tags to commits. Tracking AI usage helps teams:
- Understand AI adoption across the organization
- Measure productivity impact
- Identify best practices for AI-assisted development
- Make informed decisions about AI tooling investments

## AI Detection Patterns

### Co-Author Detection
```
Co-Authored-By: GitHub Copilot <copilot@github.com>
Co-Authored-By: Claude <claude@anthropic.com>
Co-Authored-By: Claude Sonnet 4 <noreply@anthropic.com>
Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
Co-Authored-By: Cursor <cursor@cursor.com>
Co-Authored-By: Amazon Q <q@amazon.com>
Co-Authored-By: Codeium <ai@codeium.com>
```

### Commit Message Patterns
- `[AI]` or `[ai]` prefix
- `Generated by` mentions
- Tool-specific signatures

## Tasks

### 7.1 Data Schema Updates
- [ ] Add AI-related fields to Commit type:
  ```typescript
  interface Commit {
    // ... existing fields
    aiCoAuthors: AICoAuthor[];
    isAIAssisted: boolean;
  }

  interface AICoAuthor {
    name: string;
    email: string;
    tool: 'copilot' | 'claude' | 'cursor' | 'codeium' | 'amazon-q' | 'other';
  }
  ```
- [ ] Add AI summary to CommitData
- [ ] Add AI fields to metrics output

**Acceptance Criteria:**
- All AI co-authors detected and categorized
- Tool identification is accurate
- Schema backward compatible

### 7.2 AI Detection in CLI
- [ ] Create `cli/src/extractors/ai-detection.ts`
- [ ] Implement `detectAICoAuthors(commitMessage)`:
  - Parse Co-Authored-By lines
  - Match against known AI patterns
  - Categorize by tool
- [ ] Implement `identifyAITool(email, name)`:
  - Map email domains to tools
  - Handle variations in naming
- [ ] Add configurable AI patterns in settings:
  ```json
  {
    "settings": {
      "aiPatterns": {
        "additionalEmails": ["custom-ai@company.com"],
        "excludePatterns": []
      }
    }
  }
  ```

**Acceptance Criteria:**
- Detects all major AI coding assistants
- Configurable for custom AI tools
- Low false positive rate

### 7.3 AI Metrics Calculator
- [ ] Create `cli/src/calculators/ai-metrics.ts`
- [ ] Implement metrics calculations:
  - `aiCommitsPerUser`: Count of AI-assisted commits per author
  - `aiCommitRatio`: AI commits / total commits per user
  - `aiToolUsage`: Breakdown by AI tool
  - `aiAdoptionTrend`: AI usage over time
  - `aiCommitsByTeam`: Aggregated team metrics
- [ ] Calculate comparative metrics:
  - Commit size: AI vs non-AI
  - Commit frequency: AI users vs non-AI users
  - PR merge time: AI-assisted PRs vs regular PRs

**Acceptance Criteria:**
- All metrics calculated accurately
- Team aggregations work correctly
- Trends show meaningful patterns

### 7.4 AI Metrics in Extract Command
- [ ] Update commit extraction to detect AI co-authors
- [ ] Add AI summary to extraction output
- [ ] Log AI detection statistics during extraction

**Acceptance Criteria:**
- AI detection runs during normal extraction
- Summary shows AI commit counts
- No performance degradation

### 7.5 AI Metrics in Metrics Command
- [ ] Add `ai` section to metrics output:
  ```json
  {
    "ai": {
      "summary": {
        "totalAICommits": 150,
        "totalCommits": 500,
        "aiRatio": 0.30,
        "usersWithAI": 8,
        "totalUsers": 12
      },
      "byTool": {
        "copilot": { "commits": 100, "users": 6 },
        "claude": { "commits": 50, "users": 4 }
      },
      "byUser": [...],
      "byTeam": [...],
      "trends": [...]
    }
  }
  ```
- [ ] Include AI metrics in summary output

**Acceptance Criteria:**
- AI metrics in metrics.json
- Console summary includes AI stats

### 7.6 AI Metrics Dashboard Page
- [ ] Create `src/pages/AIMetrics.tsx`
- [ ] Layout sections:
  - Overview cards (total AI commits, adoption rate, top tool)
  - AI adoption trend chart
  - Tool usage distribution (pie/donut)
  - User leaderboard
  - Team comparison
- [ ] Add to router and navigation

**Acceptance Criteria:**
- Dedicated AI metrics page
- All key metrics visible
- Consistent with dashboard style

### 7.7 AI Overview Cards
- [ ] Create `src/components/metrics/AIOverviewCards.tsx`
- [ ] Display cards:
  - Total AI-assisted commits
  - AI adoption rate (% of all commits)
  - Most used AI tool
  - Users using AI (count and %)
  - AI commits this week vs last week

**Acceptance Criteria:**
- Clear, scannable overview
- Trend indicators (up/down)
- Tooltips with definitions

### 7.8 AI Adoption Trend Chart
- [ ] Create `src/components/charts/AIAdoptionTrend.tsx`
- [ ] Line chart showing:
  - AI commits over time
  - AI ratio over time
  - Overlay: total commits for context
- [ ] Configurable time granularity (daily/weekly)

**Acceptance Criteria:**
- Clear visualization of adoption growth
- Handles sparse data
- Interactive tooltips

### 7.9 AI Tool Distribution Chart
- [ ] Create `src/components/charts/AIToolDistribution.tsx`
- [ ] Donut chart showing tool breakdown
- [ ] Legend with:
  - Tool name
  - Commit count
  - Percentage
  - User count
- [ ] Click to filter by tool

**Acceptance Criteria:**
- Visual breakdown of AI tools
- Shows relative usage clearly
- Interactive filtering

### 7.10 User AI Leaderboard
- [ ] Create `src/components/ai/UserAILeaderboard.tsx`
- [ ] Table with columns:
  - Rank
  - User (avatar, name)
  - AI Commits
  - Total Commits
  - AI Ratio (%)
  - Primary Tool
  - Trend (sparkline)
- [ ] Sortable by any column
- [ ] Filter by team

**Acceptance Criteria:**
- Shows top AI adopters
- Sortable and filterable
- Privacy consideration: opt-out option

### 7.11 Team AI Comparison
- [ ] Create `src/components/ai/TeamAIComparison.tsx`
- [ ] Bar chart comparing teams:
  - AI adoption rate
  - AI commits count
  - Tool preferences
- [ ] Table with detailed breakdown
- [ ] Drill-down to team members

**Acceptance Criteria:**
- Compare AI usage across teams
- Identify adoption leaders
- Drill-down capability

### 7.12 AI Impact Analysis
- [ ] Create `src/components/ai/AIImpactAnalysis.tsx`
- [ ] Compare metrics for AI vs non-AI work:
  - Average commit size
  - Commits per day (for AI users)
  - PR time to merge
  - Code review patterns
- [ ] Show with confidence intervals
- [ ] Caveat about correlation vs causation

**Acceptance Criteria:**
- Side-by-side comparison
- Statistical context
- Clear disclaimers

### 7.13 AI Commit Detail View
- [ ] Create `src/components/ai/AICommitList.tsx`
- [ ] List of AI-assisted commits with:
  - Commit message (truncated)
  - Author
  - AI tool used
  - Date
  - Files changed
  - Link to GitHub
- [ ] Filter by tool, user, date
- [ ] Pagination

**Acceptance Criteria:**
- Browse AI commits
- Filter and search
- Link to source

### 7.14 AI User Profile Section
- [ ] Add AI section to contributor view
- [ ] Show user's AI usage:
  - AI adoption timeline
  - Tool preferences
  - AI commit patterns (time of day)
  - Before/after AI adoption comparison

**Acceptance Criteria:**
- Personal AI insights
- Privacy-respecting
- Useful for self-improvement

### 7.15 AI Team Dashboard Widget
- [ ] Create `src/components/ai/AITeamWidget.tsx`
- [ ] Embeddable widget for team dashboard
- [ ] Show:
  - Team AI adoption rate
  - Trend arrow
  - Top AI users
  - Quick link to full AI page

**Acceptance Criteria:**
- Compact summary widget
- Works on team page
- Links to details

### 7.16 AI Metrics Alerts (Optional)
- [ ] Configure AI adoption thresholds
- [ ] Alert when:
  - AI adoption drops below threshold
  - New AI tool detected
  - User reaches AI milestone
- [ ] Configurable notifications

**Acceptance Criteria:**
- Configurable thresholds
- Meaningful alerts only
- Easy to disable

### 7.17 AI Metrics Export
- [ ] Add AI data to CSV export
- [ ] Add AI section to PDF reports
- [ ] API endpoint for AI metrics

**Acceptance Criteria:**
- AI data exportable
- Included in reports

### 7.18 AI Documentation
- [ ] Document AI detection methodology
- [ ] List supported AI tools
- [ ] Explain metrics calculations
- [ ] Add FAQ section:
  - "Why aren't my AI commits detected?"
  - "How do I add my AI tool?"
  - "What about privacy?"

**Acceptance Criteria:**
- Clear documentation
- Troubleshooting guide
- Privacy addressed

### 7.19 AI Configuration UI
- [ ] Add AI settings to Settings page
- [ ] Configure:
  - Enable/disable AI detection
  - Custom AI patterns
  - Privacy settings (anonymize AI data)
  - Alert thresholds

**Acceptance Criteria:**
- UI for AI configuration
- Changes persist
- Validation

### 7.20 Testing
- [ ] Unit tests for AI detection
- [ ] Test with various commit formats
- [ ] Test edge cases:
  - Multiple AI co-authors
  - Malformed co-author lines
  - Non-AI co-authors
- [ ] Integration tests for AI metrics
- [ ] Visual tests for AI dashboard

**Acceptance Criteria:**
- High test coverage for detection
- Edge cases handled
- No false positives in tests

## Dependencies
- Phase 2: Data Schema (for type updates)
- Phase 3: Dashboard MVP (for UI components)
- Phase 5: Team Configuration (for team aggregations)

## Deliverables
- AI detection in CLI extraction
- AI metrics calculation
- Dedicated AI metrics dashboard page
- User and team AI analytics
- AI impact analysis
- Documentation

## Metrics Definitions

| Metric | Definition | Calculation |
|--------|------------|-------------|
| **AI Commit Count** | Commits with AI co-author | `count(commits where aiCoAuthors.length > 0)` |
| **AI Adoption Rate** | Percentage of AI-assisted commits | `aiCommits / totalCommits * 100` |
| **AI User Count** | Users who have AI commits | `count(distinct(aiCommits.author))` |
| **AI User Ratio** | Percentage of users using AI | `aiUsers / totalUsers * 100` |
| **Tool Distribution** | Breakdown by AI tool | `group by aiCoAuthors.tool` |
| **AI Commit Size** | Avg lines in AI commits | `avg(aiCommits.additions + deletions)` |

## Estimated Complexity
- Schema updates: Low
- AI detection: Medium
- Metrics calculation: Medium
- Dashboard page: Medium
- Charts: Medium
- Team comparisons: Medium
- Impact analysis: High

## Privacy Considerations
- AI usage data is work-related, but can feel like surveillance
- Provide opt-out for individual contributors
- Focus on team/org level metrics, not individual performance
- Clear communication about what's tracked
- Allow anonymization of individual data

## Notes
- AI detection should be conservative (avoid false positives)
- Consider that AI patterns may change over time
- Some commits may have multiple AI co-authors
- Not all AI-assisted work adds co-author tags
- Consider adding manual AI tagging option
